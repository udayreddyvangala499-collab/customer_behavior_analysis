1Q) **what is the total revenue generated by male vs female customer?**

 	A) select gender,sum(purchase\_amount) as revenue

 	  form customer\_shopping

 	 group by gender;



**2Q) which customers used a discount but still spent more than the average purchase amount?**

 	A) select customer\_id,purchase\_amount

 	 from customer\_shopping

 	where discount\_applied='Yes' and purchase\_amount>= (select AVG(purchase\_amount) from customer\_shopping);



**3Q) which are the top 5 products with highest average rating ?**

 	A) select item\_purchased, ROUND(AVG(review\_rating::numeric),2) as "Average Product Rating"

 	from customer\_shopping

 	group by item\_purchased

 	order by avg(review\_rating) desc limit 5;



**4Q) compare the average purchase amounts between standard and express shipping?**

 	A) select shipping\_type ROUND(AVG(purchase\_amount),2)

 	 from customer\_shopping

 	where shipping\_type in ('standard','Express')

 	 group by shipping\_type;



**5Q) Do subscribed customers spend more? Compare average speed and total revenue between subscribers and non-subscribers?**

 	A) select subscription\_status,COUNT(customer\_id) as total\_customers, ROUND(AVG(purchase\_amount),2) as avg\_spend, ROUND(SUM(purchase\_amount),2) as total\_revenue

 	from customer\_shopping

 	group by subscription\_status

 	order by total\_revenue, avg\_spend desc;



**6Q) which 5 products have the highest percentage pf purchases with discounts applied?**

 	A) select item\_purchased,

 	    ROUND(100\*SUM(CASE WHEN discount\_applied='Yes' THEN 1 ELSE 0 END)/COUNT(\*) ,2) as discount\_rate

 	    from customer\_shopping

 	    group by item\_purchased

 	    order by discount\_rate desc limit 5;



**7Q) Segment  customers into New, Returning, and Loyal based on their total number of previous purchases, and show the count of each segment?**

 	A)  with customer\_type as(

 	    select customer\_id,previous\_purchases,

 	     CASE

 		WHEN previous\_purchases =1 THEN 'New'

 		WHEN previous\_purchases BETWEEN 2 and 10 THEN 'Returning'

 		ELSE 'Loyal'

 		END AS customer\_segment

 	     from customer\_shopping

 	     )

 	     select customer\_segment, count(\*) as "Number of Customers"

 	     from customer\_type

 	     group by customer\_segment;



**8Q) What are the top 3 most purchased products within each category?**

 	A) with item\_counts as (

 	   select category,

 	   item\_purchased,

 	   COUNT(customer\_id) as total\_orders,

 	   ROW\_NUMBER() over(partition by category order by count(customer\_id)DESC) as item\_rank

 	   from customer\_shopping

 	   group by category,item\_purchased

 	   )

 	   select item\_rank, category,item\_purchased,total\_orders

 	   from item\_counts

 	   where item\_rank <=3;

 

**9Q) Are customers who are repeat buyers (more than 5 previous purchases) also likely to subscribe?**

 	A) select subscription\_status,

 	   count(customer\_id) as repeat\_buyers

 	   from customer\_shopping

 	   where previous\_purchases >5

 	   group by subscription\_status;



**10Q) what is the revenue contribution of each age group?**

 	A) select age\_group,

 	   SUM(purchase\_amount) as total\_revenue

 	   from customer\_shopping

 	   group by age\_group

 	   order by total\_revenue desc;



 

